<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.3.dev21+g251d61a.d20210524" />
<title>vipy.globals API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>vipy.globals</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L1-L218" class="git-link">Browse git</a>
</summary>
<pre><code class="python">import os
import webbrowser
import dill
import tempfile
import vipy.math
from vipy.util import remkdir, tempdir
import builtins
import logging as python_logging
import warnings


# Global mutable dictionary
GLOBAL = {&#39;VERBOSE&#39;: True,       # If False, will silence everything, equivalent to calling vipy.globals.silent()
          &#39;VERBOSITY&#39;: 2,        # 0=debug, 1=warn, 2=info, only if VERBOSE=True
          &#39;DASK_CLIENT&#39;: None,   # Global Dask() client for distributed processing
          &#39;CACHE&#39;:os.environ[&#39;VIPY_CACHE&#39;] if &#39;VIPY_CACHE&#39; in os.environ else None,   # Cache directory for vipy.video and vipy.image donwloads
          &#39;GPU&#39;:None,            # GPU index assigned to this process
          &#39;LOGGING&#39;:False,       # If True, use python logging (handler provided by end-user) intead of print 
          &#39;LOGGER&#39;:None,         # The global logger used by vipy.globals.print() and vipy.globals.warn() if LOGGING=True
          &#39;GUI&#39;:{&#39;escape&#39;:False},
          &#39;AWS&#39;:{&#39;AWS_ACCESS_KEY_ID&#39;:os.environ[&#39;VIPY_AWS_SECRET_ACCESS_KEY&#39;] if &#39;VIPY_AWS_ACCESS_KEY_ID&#39; in os.environ else None,
                 &#39;AWS_SECRET_ACCESS_KEY&#39;:os.environ[&#39;VIPY_AWS_SECRET_ACCESS_KEY&#39;] if &#39;VIPY_AWS_SECRET_ACCESS_KEY&#39; in os.environ else None,
                 &#39;AWS_SESSION_TOKEN&#39;:os.environ[&#39;VIPY_AWS_SESSION_TOKEN&#39;] if &#39;VIPY_AWS_SESSION_TOKEN&#39; in os.environ else None},
          &#39;LATEX&#39;:os.environ[&#39;VIPY_LATEX&#39;] if &#39;VIPY_LATEX&#39; in os.environ else None}


def logging(enable=None, format=None):
    &#34;&#34;&#34;Single entry point for enabling/disabling logging vs. printing
       
       All vipy functions overload &#34;from vipy.globals import print&#34; for simplified readability of code.
       This global function redirects print or warn to using the standard logging module.
       If format is provided, this will create a basicConfig handler, but this should be configured by the end-user.    
    &#34;&#34;&#34;
    if enable is not None:
        assert isinstance(enable, bool)
        GLOBAL[&#39;LOGGING&#39;] = enable
        if format is not None:
            python_logging.basicConfig(level=python_logging.INFO, format=format)
        GLOBAL[&#39;LOGGER&#39;] = python_logging.getLogger(&#39;vipy&#39;)
        GLOBAL[&#39;LOGGER&#39;].propagate = True if enable else False
        
    return GLOBAL[&#39;LOGGING&#39;]


def warn(s):
    if GLOBAL[&#39;VERBOSE&#39;]:
        warnings.warn(s) if (not GLOBAL[&#39;LOGGING&#39;] or GLOBAL[&#39;LOGGER&#39;] is None) else GLOBAL[&#39;LOGGER&#39;].warn(s)

        
def print(s, end=&#39;\n&#39;):
    &#34;&#34;&#34;Main entry point for all print statements in the vipy package. All vipy code calls this to print helpful messages.

    .. notes::
        -Printing can be disabled by calling vipy.globals.silent()
        -Printing can be redirected to logging by calling vipy.globals.logging(True)
        -All print() statements in vipy.* are overloaded to call vipy.globals.print() so that it can be redirected to logging

    &#34;&#34;&#34;
    if GLOBAL[&#39;VERBOSE&#39;]:
        builtins.print(s, end=end) if (not GLOBAL[&#39;LOGGING&#39;] or GLOBAL[&#39;LOGGER&#39;] is None) else GLOBAL[&#39;LOGGER&#39;].info(s)


def verbose():
    &#34;&#34;&#34;The global verbosity level, only really used right now for FFMPEG messages&#34;&#34;&#34;
    GLOBAL[&#39;VERBOSE&#39;] = True

def isverbose():
    return GLOBAL[&#39;VERBOSE&#39;]

def silent():
    &#34;&#34;&#34;Silence the global verbosity level, only really used right now for FFMPEG messages&#34;&#34;&#34;
    GLOBAL[&#39;VERBOSE&#39;] = False    

def issilent():
    &#34;&#34;&#34;Is the global verbosity silent?&#34;&#34;&#34;
    return GLOBAL[&#39;VERBOSE&#39;] == False 

def verbosity(v):
    &#34;&#34;&#34;Set the global verbosity level [0,1,2]=debug, warn, info&#34;&#34;&#34;
    assert v in [0,1,2]    # debug, warn, info
    GLOBAL[&#39;VERBOSITY&#39;] = v

def debug():
    verbose()
    verbosity(0)

def isdebug():
    return GLOBAL[&#39;VERBOSE&#39;] and GLOBAL[&#39;VERBOSITY&#39;] == 0


def cache(cachedir=None):
    &#34;&#34;&#34;The cache is the location that URLs are downloaded to on your system.  This can be set here, or with the environment variable VIPY_CACHE

    &gt;&gt;&gt; vipy.globals.cache(&#39;/path/to/.vipy&#39;)
    &gt;&gt;&gt; cachedir = vipy.globals.cache()

    Args:
        cachedir:  the location to store cached files when downloaded.  Can also be set using the VIPY_CACHE environment variable.  if none, return the current cachedir
    
    Returns:
        The current cachedir if cachedir=None else None
    
    &#34;&#34;&#34;
    if cachedir is not None:
        os.environ[&#39;VIPY_CACHE&#39;] = remkdir(cachedir)
        GLOBAL[&#39;CACHE&#39;] = cachedir
    return os.environ[&#39;VIPY_CACHE&#39;] if &#39;VIPY_CACHE&#39; in os.environ else None
    

def _user_hit_escape(b=None):
    &#34;&#34;&#34;Did the user hit the escape key?  Useful for matplotlib GUI to stop displaying video&#34;&#34;&#34;
    if b is None:
        if GLOBAL[&#39;GUI&#39;][&#39;escape&#39;]:
            GLOBAL[&#39;GUI&#39;][&#39;escape&#39;] = False  # toggle it
            return True
        else:
            return False
    else:
        # Set in vipy.gui.using_matplotlib.escape_to_exit()
        assert isinstance(b, bool)
        GLOBAL[&#39;GUI&#39;][&#39;escape&#39;] = b  
            
def cpuonly():
    GLOBAL[&#39;GPU&#39;] = None


def gpuindex(gpu=None):
    if gpu == &#39;cpu&#39;:
        cpuonly()
    elif gpu is not None:
        GLOBAL[&#39;GPU&#39;] = gpu
    return GLOBAL[&#39;GPU&#39;]


def dask(num_processes=None, num_gpus=None, dashboard=False, address=None, pct=None):
    &#34;&#34;&#34;Return the current Dask client, can be accessed globally for parallel processing.
    
    Args:
        pct: float in [0,1] the percentage of the current machine to use
        address:  the dask scheduler of the form &#39;HOSTNAME:PORT&#39;
        num_processes:  the number of prpcesses to use on the current machine
        num_gpus:  the number of GPUs to use on the current machine
        dashboard: [bool] whether to inialize the dask client with a web dashboard

    Returns:
        The `vipy.batch.Dask` object pointing to the Dask Distrbuted object
    &#34;&#34;&#34;
    from vipy.batch import Dask
    if pct is not None:
        assert pct &gt; 0 and pct &lt;= 1
        import multiprocessing
        num_processes = vipy.math.poweroftwo(pct*multiprocessing.cpu_count())        
    if (address is not None or (num_processes is not None and (GLOBAL[&#39;DASK_CLIENT&#39;] is None or GLOBAL[&#39;DASK_CLIENT&#39;].num_processes() != num_processes)) or num_gpus is not None):
        GLOBAL[&#39;DASK_CLIENT&#39;] = Dask(num_processes, dashboard=dashboard, verbose=isverbose(), address=address, num_gpus=num_gpus)        
    return GLOBAL[&#39;DASK_CLIENT&#39;]


def parallel(n=None, pct=None, scheduler=None):
    &#34;&#34;&#34;Enable parallel processing with n&gt;=1 processes or a percentage of system core (pct \in [0,1]) or a dask scheduler .

    This can be be used as a context manager
    
    &gt;&gt;&gt; with vipy.globals.parallel(n=4):
    &gt;&gt;&gt;     vipy.batch.Batch(...)

    or using the global variables:

    &gt;&gt;&gt; vipy.globals.parallel(n=4):
    &gt;&gt;&gt; vipy.batch.Batch(...)
    &gt;&gt;&gt; vipy.globals.noparallel()
    
    To check the current parallelism level:
    
    &gt;&gt;&gt; num_processes = vipy.globals.parallel()

    To run with a dask scheduler:
    
    &gt;&gt;&gt; with vipy.globals.parallel(scheduler=&#39;10.0.1.1:8585&#39;)
    &gt;&gt;&gt;    vipy.batch.Batch(...)

    Args:
        n: [int] number of parallel processes
        pct: [float] the percentage [0,1] of system cores to dedicate to parallel processing
        scheduler: [str]  the dask scheduler of the form &#39;HOSTNAME:PORT&#39; like &#39;128.0.0.1:8785&#39;.  See &lt;https://docs.dask.org/en/latest/install.html&gt;
    &#34;&#34;&#34;

    class Parallel():
        def __init__(self, n=None, pct=None, scheduler=None):
            assert n is not None or pct is not None or scheduler is not None
            assert sum([x is not None for x in (n, pct, scheduler)]) == 1, &#34;Exactly one&#34;
            assert n is None or (isinstance(n, int) and n&gt;=1)
            assert pct is None or (pct &gt; 0 and pct &lt;= 1)
            dask(num_processes=n, pct=pct, address=scheduler)
            
        def __enter__(self):
            pass

        def __exit__(self, *args):
            noparallel()

    if n is None and pct is None and scheduler is None:
        return GLOBAL[&#39;DASK_CLIENT&#39;].num_processes() if  GLOBAL[&#39;DASK_CLIENT&#39;] is not None else 0
    else:
        assert n is not None or pct is not None or scheduler is not None
        assert sum([x is not None for x in (n, pct, scheduler)]) == 1, &#34;Exactly one&#34;
        return Parallel(n=n, pct=pct, scheduler=scheduler) 



def noparallel():
    &#34;&#34;&#34;Disable all parallel processing&#34;&#34;&#34;
    if GLOBAL[&#39;DASK_CLIENT&#39;] is not None:
        GLOBAL[&#39;DASK_CLIENT&#39;].shutdown()
    GLOBAL[&#39;DASK_CLIENT&#39;] = None 

def nodask():
    &#34;&#34;&#34;Alias for `vipy.globals.noparallel`&#34;&#34;&#34;
    return noparallel()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="vipy.globals.cache"><code class="name flex">
<span>def <span class="ident">cache</span></span>(<span>cachedir=None)</span>
</code></dt>
<dd>
<div class="desc"><p>The cache is the location that URLs are downloaded to on your system.
This can be set here, or with the environment variable VIPY_CACHE</p>
<pre><code class="language-python-repl">&gt;&gt;&gt; vipy.globals.cache('/path/to/.vipy')
&gt;&gt;&gt; cachedir = vipy.globals.cache()
</code></pre>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>cachedir</code></strong></dt>
<dd>the location to store cached files when downloaded.
Can also be set using the VIPY_CACHE environment variable.
if none, return the current cachedir</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>The current cachedir if cachedir=None else None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L91-L107" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def cache(cachedir=None):
    &#34;&#34;&#34;The cache is the location that URLs are downloaded to on your system.  This can be set here, or with the environment variable VIPY_CACHE

    &gt;&gt;&gt; vipy.globals.cache(&#39;/path/to/.vipy&#39;)
    &gt;&gt;&gt; cachedir = vipy.globals.cache()

    Args:
        cachedir:  the location to store cached files when downloaded.  Can also be set using the VIPY_CACHE environment variable.  if none, return the current cachedir
    
    Returns:
        The current cachedir if cachedir=None else None
    
    &#34;&#34;&#34;
    if cachedir is not None:
        os.environ[&#39;VIPY_CACHE&#39;] = remkdir(cachedir)
        GLOBAL[&#39;CACHE&#39;] = cachedir
    return os.environ[&#39;VIPY_CACHE&#39;] if &#39;VIPY_CACHE&#39; in os.environ else None</code></pre>
</details>
</dd>
<dt id="vipy.globals.cpuonly"><code class="name flex">
<span>def <span class="ident">cpuonly</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L123-L124" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def cpuonly():
    GLOBAL[&#39;GPU&#39;] = None</code></pre>
</details>
</dd>
<dt id="vipy.globals.dask"><code class="name flex">
<span>def <span class="ident">dask</span></span>(<span>num_processes=None, num_gpus=None, dashboard=False, address=None, pct=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Return the current Dask client, can be accessed globally for parallel processing.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pct</code></strong></dt>
<dd>float in [0,1] the percentage of the current machine to use</dd>
<dt><strong><code>address</code></strong></dt>
<dd>the dask scheduler of the form 'HOSTNAME:PORT'</dd>
<dt><strong><code>num_processes</code></strong></dt>
<dd>the number of prpcesses to use on the current machine</dd>
<dt><strong><code>num_gpus</code></strong></dt>
<dd>the number of GPUs to use on the current machine</dd>
<dt><strong><code>dashboard</code></strong></dt>
<dd>[bool] whether to inialize the dask client with a web dashboard</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>The <code><a title="vipy.batch.Dask" href="batch.html#vipy.batch.Dask">Dask</a></code> object pointing to the Dask Distrbuted object</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L135-L155" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dask(num_processes=None, num_gpus=None, dashboard=False, address=None, pct=None):
    &#34;&#34;&#34;Return the current Dask client, can be accessed globally for parallel processing.
    
    Args:
        pct: float in [0,1] the percentage of the current machine to use
        address:  the dask scheduler of the form &#39;HOSTNAME:PORT&#39;
        num_processes:  the number of prpcesses to use on the current machine
        num_gpus:  the number of GPUs to use on the current machine
        dashboard: [bool] whether to inialize the dask client with a web dashboard

    Returns:
        The `vipy.batch.Dask` object pointing to the Dask Distrbuted object
    &#34;&#34;&#34;
    from vipy.batch import Dask
    if pct is not None:
        assert pct &gt; 0 and pct &lt;= 1
        import multiprocessing
        num_processes = vipy.math.poweroftwo(pct*multiprocessing.cpu_count())        
    if (address is not None or (num_processes is not None and (GLOBAL[&#39;DASK_CLIENT&#39;] is None or GLOBAL[&#39;DASK_CLIENT&#39;].num_processes() != num_processes)) or num_gpus is not None):
        GLOBAL[&#39;DASK_CLIENT&#39;] = Dask(num_processes, dashboard=dashboard, verbose=isverbose(), address=address, num_gpus=num_gpus)        
    return GLOBAL[&#39;DASK_CLIENT&#39;]</code></pre>
</details>
</dd>
<dt id="vipy.globals.debug"><code class="name flex">
<span>def <span class="ident">debug</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L83-L85" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def debug():
    verbose()
    verbosity(0)</code></pre>
</details>
</dd>
<dt id="vipy.globals.gpuindex"><code class="name flex">
<span>def <span class="ident">gpuindex</span></span>(<span>gpu=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L127-L132" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def gpuindex(gpu=None):
    if gpu == &#39;cpu&#39;:
        cpuonly()
    elif gpu is not None:
        GLOBAL[&#39;GPU&#39;] = gpu
    return GLOBAL[&#39;GPU&#39;]</code></pre>
</details>
</dd>
<dt id="vipy.globals.isdebug"><code class="name flex">
<span>def <span class="ident">isdebug</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L87-L88" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def isdebug():
    return GLOBAL[&#39;VERBOSE&#39;] and GLOBAL[&#39;VERBOSITY&#39;] == 0</code></pre>
</details>
</dd>
<dt id="vipy.globals.issilent"><code class="name flex">
<span>def <span class="ident">issilent</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Is the global verbosity silent?</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L74-L76" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def issilent():
    &#34;&#34;&#34;Is the global verbosity silent?&#34;&#34;&#34;
    return GLOBAL[&#39;VERBOSE&#39;] == False </code></pre>
</details>
</dd>
<dt id="vipy.globals.isverbose"><code class="name flex">
<span>def <span class="ident">isverbose</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L67-L68" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def isverbose():
    return GLOBAL[&#39;VERBOSE&#39;]</code></pre>
</details>
</dd>
<dt id="vipy.globals.logging"><code class="name flex">
<span>def <span class="ident">logging</span></span>(<span>enable=None, format=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Single entry point for enabling/disabling logging vs. printing</p>
<p>All vipy functions overload "from vipy.globals import print" for simplified readability of code.
This global function redirects print or warn to using the standard logging module.
If format is provided, this will create a basicConfig handler, but this should be configured by the end-user.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L27-L42" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def logging(enable=None, format=None):
    &#34;&#34;&#34;Single entry point for enabling/disabling logging vs. printing
       
       All vipy functions overload &#34;from vipy.globals import print&#34; for simplified readability of code.
       This global function redirects print or warn to using the standard logging module.
       If format is provided, this will create a basicConfig handler, but this should be configured by the end-user.    
    &#34;&#34;&#34;
    if enable is not None:
        assert isinstance(enable, bool)
        GLOBAL[&#39;LOGGING&#39;] = enable
        if format is not None:
            python_logging.basicConfig(level=python_logging.INFO, format=format)
        GLOBAL[&#39;LOGGER&#39;] = python_logging.getLogger(&#39;vipy&#39;)
        GLOBAL[&#39;LOGGER&#39;].propagate = True if enable else False
        
    return GLOBAL[&#39;LOGGING&#39;]</code></pre>
</details>
</dd>
<dt id="vipy.globals.nodask"><code class="name flex">
<span>def <span class="ident">nodask</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Alias for <code><a title="vipy.globals.noparallel" href="#vipy.globals.noparallel">noparallel()</a></code></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L216-L218" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def nodask():
    &#34;&#34;&#34;Alias for `vipy.globals.noparallel`&#34;&#34;&#34;
    return noparallel()</code></pre>
</details>
</dd>
<dt id="vipy.globals.noparallel"><code class="name flex">
<span>def <span class="ident">noparallel</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Disable all parallel processing</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L210-L214" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def noparallel():
    &#34;&#34;&#34;Disable all parallel processing&#34;&#34;&#34;
    if GLOBAL[&#39;DASK_CLIENT&#39;] is not None:
        GLOBAL[&#39;DASK_CLIENT&#39;].shutdown()
    GLOBAL[&#39;DASK_CLIENT&#39;] = None </code></pre>
</details>
</dd>
<dt id="vipy.globals.parallel"><code class="name flex">
<span>def <span class="ident">parallel</span></span>(<span>n=None, pct=None, scheduler=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Enable parallel processing with n&gt;=1 processes or a percentage of system core (pct \in [0,1]) or a dask scheduler .</p>
<p>This can be be used as a context manager</p>
<pre><code class="language-python-repl">&gt;&gt;&gt; with vipy.globals.parallel(n=4):
&gt;&gt;&gt;     vipy.batch.Batch(...)
</code></pre>
<p>or using the global variables:</p>
<pre><code class="language-python-repl">&gt;&gt;&gt; vipy.globals.parallel(n=4):
&gt;&gt;&gt; vipy.batch.Batch(...)
&gt;&gt;&gt; vipy.globals.noparallel()
</code></pre>
<p>To check the current parallelism level:</p>
<pre><code class="language-python-repl">&gt;&gt;&gt; num_processes = vipy.globals.parallel()
</code></pre>
<p>To run with a dask scheduler:</p>
<pre><code class="language-python-repl">&gt;&gt;&gt; with vipy.globals.parallel(scheduler='10.0.1.1:8585')
&gt;&gt;&gt;    vipy.batch.Batch(...)
</code></pre>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>n</code></strong></dt>
<dd>[int] number of parallel processes</dd>
<dt><strong><code>pct</code></strong></dt>
<dd>[float] the percentage [0,1] of system cores to dedicate to parallel processing</dd>
<dt><strong><code>scheduler</code></strong></dt>
<dd>[str]
the dask scheduler of the form 'HOSTNAME:PORT' like '128.0.0.1:8785'.
See <a href="https://docs.dask.org/en/latest/install.html">https://docs.dask.org/en/latest/install.html</a></dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L158-L206" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def parallel(n=None, pct=None, scheduler=None):
    &#34;&#34;&#34;Enable parallel processing with n&gt;=1 processes or a percentage of system core (pct \in [0,1]) or a dask scheduler .

    This can be be used as a context manager
    
    &gt;&gt;&gt; with vipy.globals.parallel(n=4):
    &gt;&gt;&gt;     vipy.batch.Batch(...)

    or using the global variables:

    &gt;&gt;&gt; vipy.globals.parallel(n=4):
    &gt;&gt;&gt; vipy.batch.Batch(...)
    &gt;&gt;&gt; vipy.globals.noparallel()
    
    To check the current parallelism level:
    
    &gt;&gt;&gt; num_processes = vipy.globals.parallel()

    To run with a dask scheduler:
    
    &gt;&gt;&gt; with vipy.globals.parallel(scheduler=&#39;10.0.1.1:8585&#39;)
    &gt;&gt;&gt;    vipy.batch.Batch(...)

    Args:
        n: [int] number of parallel processes
        pct: [float] the percentage [0,1] of system cores to dedicate to parallel processing
        scheduler: [str]  the dask scheduler of the form &#39;HOSTNAME:PORT&#39; like &#39;128.0.0.1:8785&#39;.  See &lt;https://docs.dask.org/en/latest/install.html&gt;
    &#34;&#34;&#34;

    class Parallel():
        def __init__(self, n=None, pct=None, scheduler=None):
            assert n is not None or pct is not None or scheduler is not None
            assert sum([x is not None for x in (n, pct, scheduler)]) == 1, &#34;Exactly one&#34;
            assert n is None or (isinstance(n, int) and n&gt;=1)
            assert pct is None or (pct &gt; 0 and pct &lt;= 1)
            dask(num_processes=n, pct=pct, address=scheduler)
            
        def __enter__(self):
            pass

        def __exit__(self, *args):
            noparallel()

    if n is None and pct is None and scheduler is None:
        return GLOBAL[&#39;DASK_CLIENT&#39;].num_processes() if  GLOBAL[&#39;DASK_CLIENT&#39;] is not None else 0
    else:
        assert n is not None or pct is not None or scheduler is not None
        assert sum([x is not None for x in (n, pct, scheduler)]) == 1, &#34;Exactly one&#34;
        return Parallel(n=n, pct=pct, scheduler=scheduler) </code></pre>
</details>
</dd>
<dt id="vipy.globals.print"><code class="name flex">
<span>def <span class="ident">print</span></span>(<span>s, end='\n')</span>
</code></dt>
<dd>
<div class="desc"><p>Main entry point for all print statements in the vipy package. All vipy code calls this to print helpful messages.</p>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>-Printing can be disabled by calling vipy.globals.silent()
-Printing can be redirected to logging by calling vipy.globals.logging(True)
-All print() statements in vipy.* are overloaded to call vipy.globals.print() so that it can be redirected to logging</p>
</div></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L50-L60" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def print(s, end=&#39;\n&#39;):
    &#34;&#34;&#34;Main entry point for all print statements in the vipy package. All vipy code calls this to print helpful messages.

    .. notes::
        -Printing can be disabled by calling vipy.globals.silent()
        -Printing can be redirected to logging by calling vipy.globals.logging(True)
        -All print() statements in vipy.* are overloaded to call vipy.globals.print() so that it can be redirected to logging

    &#34;&#34;&#34;
    if GLOBAL[&#39;VERBOSE&#39;]:
        builtins.print(s, end=end) if (not GLOBAL[&#39;LOGGING&#39;] or GLOBAL[&#39;LOGGER&#39;] is None) else GLOBAL[&#39;LOGGER&#39;].info(s)</code></pre>
</details>
</dd>
<dt id="vipy.globals.silent"><code class="name flex">
<span>def <span class="ident">silent</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Silence the global verbosity level, only really used right now for FFMPEG messages</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L70-L72" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def silent():
    &#34;&#34;&#34;Silence the global verbosity level, only really used right now for FFMPEG messages&#34;&#34;&#34;
    GLOBAL[&#39;VERBOSE&#39;] = False    </code></pre>
</details>
</dd>
<dt id="vipy.globals.verbose"><code class="name flex">
<span>def <span class="ident">verbose</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>The global verbosity level, only really used right now for FFMPEG messages</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L63-L65" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def verbose():
    &#34;&#34;&#34;The global verbosity level, only really used right now for FFMPEG messages&#34;&#34;&#34;
    GLOBAL[&#39;VERBOSE&#39;] = True</code></pre>
</details>
</dd>
<dt id="vipy.globals.verbosity"><code class="name flex">
<span>def <span class="ident">verbosity</span></span>(<span>v)</span>
</code></dt>
<dd>
<div class="desc"><p>Set the global verbosity level [0,1,2]=debug, warn, info</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L78-L81" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def verbosity(v):
    &#34;&#34;&#34;Set the global verbosity level [0,1,2]=debug, warn, info&#34;&#34;&#34;
    assert v in [0,1,2]    # debug, warn, info
    GLOBAL[&#39;VERBOSITY&#39;] = v</code></pre>
</details>
</dd>
<dt id="vipy.globals.warn"><code class="name flex">
<span>def <span class="ident">warn</span></span>(<span>s)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/visym/vipy/blob/9104ff42b3d76273c8341abf5499fc7e29315d36/vipy/globals.py#L45-L47" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def warn(s):
    if GLOBAL[&#39;VERBOSE&#39;]:
        warnings.warn(s) if (not GLOBAL[&#39;LOGGING&#39;] or GLOBAL[&#39;LOGGER&#39;] is None) else GLOBAL[&#39;LOGGER&#39;].warn(s)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<header>
<a class="homelink" rel="home" title="Vipy" href="https://github.com/visym/vipy/">
<img src="https://www.visym.com/labs/images/visym_logo_black_notext.png" alt="" width="150"> <p> </p>
</a>
</header>
<form>
<input id="lunr-search" name="q" placeholder="🔎 Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="vipy" href="index.html">vipy</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="vipy.globals.cache" href="#vipy.globals.cache">cache</a></code></li>
<li><code><a title="vipy.globals.cpuonly" href="#vipy.globals.cpuonly">cpuonly</a></code></li>
<li><code><a title="vipy.globals.dask" href="#vipy.globals.dask">dask</a></code></li>
<li><code><a title="vipy.globals.debug" href="#vipy.globals.debug">debug</a></code></li>
<li><code><a title="vipy.globals.gpuindex" href="#vipy.globals.gpuindex">gpuindex</a></code></li>
<li><code><a title="vipy.globals.isdebug" href="#vipy.globals.isdebug">isdebug</a></code></li>
<li><code><a title="vipy.globals.issilent" href="#vipy.globals.issilent">issilent</a></code></li>
<li><code><a title="vipy.globals.isverbose" href="#vipy.globals.isverbose">isverbose</a></code></li>
<li><code><a title="vipy.globals.logging" href="#vipy.globals.logging">logging</a></code></li>
<li><code><a title="vipy.globals.nodask" href="#vipy.globals.nodask">nodask</a></code></li>
<li><code><a title="vipy.globals.noparallel" href="#vipy.globals.noparallel">noparallel</a></code></li>
<li><code><a title="vipy.globals.parallel" href="#vipy.globals.parallel">parallel</a></code></li>
<li><code><a title="vipy.globals.print" href="#vipy.globals.print">print</a></code></li>
<li><code><a title="vipy.globals.silent" href="#vipy.globals.silent">silent</a></code></li>
<li><code><a title="vipy.globals.verbose" href="#vipy.globals.verbose">verbose</a></code></li>
<li><code><a title="vipy.globals.verbosity" href="#vipy.globals.verbosity">verbosity</a></code></li>
<li><code><a title="vipy.globals.warn" href="#vipy.globals.warn">warn</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.9.3.dev21+g251d61a.d20210524</a>.</p>
</footer>
</body>
</html>